<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CropCart • Store</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <!-- Your brand layer on top of Bootstrap -->
    <link rel="stylesheet" href="./styles/style.css" />

    <!-- Config + helpers -->
    <script src="./scripts/config.js"></script>
    <script src="./scripts/utils.js"></script>

    <!-- Auth + shared boot logic -->
    <script defer src="./scripts/auth.js"></script>
    <script defer src="./scripts/page.js"></script>

    <!-- Store logic -->
    <script defer src="./scripts/store.js"></script>
  </head>

  <body data-page="store" class="cc-body">
    <!-- ========================================================= -->
    <!-- NAVBAR                                                    -->
    <!-- ========================================================= -->
    <nav class="navbar navbar-expand-lg cc-navbar sticky-top">
      <div class="container-xxl px-3">
        <a
          class="navbar-brand d-flex align-items-center gap-2"
          href="index.html"
        >
          <img
            class="cc-mark"
            src="./Images/CClogo1.png"
            alt="Crop Cart Logo IMG"
          />
          <span class="fw-bold">CropCart</span>
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#ccNav"
          aria-controls="ccNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="ccNav">
          <ul class="navbar-nav ms-auto gap-lg-2">
            <li class="nav-item">
              <a class="nav-link active" href="index.html">Store</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cart.html">My Cart</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="farmer.html">Farmer Portal</a>
            </li>
            <li>
              <ul class="navbar-nav ms-auto gap-lg-2" id="authNav">
                <!-- auth.js populates this -->
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- ========================================================= -->
    <!-- MAIN                                                      -->
    <!-- ========================================================= -->
    <main class="container-xxl px-3 pb-5">
      <!-- Hero / Filters -->
      <section class="row g-3 g-lg-4 align-items-stretch mt-3">
        <div class="col-12 col-lg-8">
          <div class="cc-card h-100">
            <div
              class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2"
            >
              <div>
                <h1 class="cc-h1 mb-1">Shop Local, Eat Better!</h1>
                <p class="cc-sub mb-0">
                  Produce, Meat, Eggs, Honey, and More! All from local farms,
                  all in one cart.
                </p>
              </div>
            </div>

            <hr class="cc-hr" />

            <!-- Controls (IDs must match store.js) -->
            <div class="row g-3 align-items-end">
              <div class="col-12">
                <label class="form-label cc-label" for="productSearch"
                  >Search</label
                >
                <input
                  id="productSearch"
                  class="form-control cc-input"
                  placeholder="Tomatoes, honey, eggs..."
                />
              </div>

              <div class="col-12 col-md-6 cc-select-wrapper">
                <label class="form-label cc-label" for="productCategory"
                  >Category Filter:</label
                >
                <select id="productCategory" class="form-select cc-select">
                  <option>All</option>
                  <option>Fruits & Vegetables</option>
                  <option>Meat & Poultry</option>
                  <option>Dairy & Eggs</option>
                  <option>Grains & Bakery</option>
                  <option>Herbs & Spices</option>
                  <option>Honey & Preserves</option>
                  <option>Beverages</option>
                  <option>Other</option>
                </select>
              </div>

              <div class="col-12 col-md-6 cc-select-wrapper">
                <label class="form-label cc-label" for="productSort"
                  >Sort By:</label
                >
                <select id="productSort" class="form-select cc-select">
                  <option>Recommended</option>
                  <option>Price: Low → High</option>
                  <option>Price: High → Low</option>
                  <option>Stock: High → Low</option>
                  <option>Farm: A→Z</option>
                  <option>Farm: Z→A</option>
                  <option>Farm Location: A-Z</option>
                  <option value="favorites">Favorite Farms</option>
                </select>
              </div>

              <!-- Farm Filter -->
              <div class="col-12 col-md-6 cc-select-wrapper">
                <label class="form-label cc-label" for="productFarm"
                  >Filter By Farm:</label
                >
                <select id="productFarm" class="form-select cc-select">
                  <option value="all">All Farms</option>
                  <!-- store.js will populate the rest -->
                </select>
              </div>

              <!-- Location filter -->
              <div class="col-12 col-md-6 cc-select-wrapper">
                <label class="form-label cc-label" for="productLocation"
                  >Filter By Location:</label
                >
                <select id="productLocation" class="form-select cc-select">
                  <option value="All">All locations</option>
                  <!-- store.js auto-populates after products load -->
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Side card -->
        <div class="col-12 col-lg-4">
          <div class="cc-card h-100">
            <div id="favoriteFarmsHost" class="d-grid gap-2">
              <div class="alert alert-info text-muted small">
                Sign in and favorite some farms to see them listed here.
              </div>
            </div>

            <br />
            <hr class="cc-hr" />

            <div class="d-flex align-items-center justify-content-between">
              <small class="cc-muted">Partner delivery available</small>
            </div>
          </div>
        </div>
      </section>

      <!-- Products -->
      <section class="mt-4">
        <div
          class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2"
        >
          <h2 class="cc-h2 m-0">Products</h2>
        </div>

        <div class="cc-card">
          <div id="products"></div>
        </div>
      </section>
    </main>

    <!-- ========================================================= -->
    <!-- FOOTER                                                    -->
    <!-- ========================================================= -->
    <footer class="cc-footer">
      <div class="container-xxl px-3 py-4">
        <div
          class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2"
        >
          <small class="cc-muted">© CropCart • Farm-to-table delivery</small>
          <small class="cc-muted">Built with Bootstrap</small>
        </div>
      </div>
    </footer>

    <!-- ========================================================= -->
    <!-- PRODUCT DETAILS MODAL (IDs must match store.js)            -->
    <!-- ========================================================= -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <div class="d-flex flex-column">
              <h5 class="modal-title m-0" id="productModalTitle">Product</h5>
              <small class="text-muted" id="productModalSubtitle"></small>
            </div>

            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>

          <div class="modal-body">
            <div class="row g-3">
              <!-- Left: Image -->
              <div class="col-12 col-lg-6">
                <div class="cc-card p-2">
                  <img
                    id="productModalImg"
                    class="img-fluid rounded w-100 cc-product-modal-img"
                    src=""
                    alt="Product image"
                  />

                  <!-- fallback initial (shown only when no image) -->
                  <div
                    id="productModalImgFallback"
                    class="d-none rounded d-flex align-items-center justify-content-center fw-bold cc-product-modal-fallback"
                  >
                    <span id="productModalInitial">P</span>
                  </div>
                </div>
              </div>

              <!-- Right: Details + Qty -->
              <div class="col-12 col-lg-6">
                <div class="cc-card p-3 h-100">
                  <div class="mb-2 d-flex align-items-center flex-column">
                    <div class="d-flex gap-2 mb-2">
                      <span
                        class="badge rounded-pill text-bg-light cc-badge"
                        id="productModalCategory"
                        >Category</span
                      >
                      <span
                        class="badge rounded-pill text-bg-light cc-badge"
                        id="productModalStock"
                        >Stock: —</span
                      >
                    </div>

                    <div class="fw-semibold mt-1">Provided by</div>
                  </div>

                  <div class="d-flex justify-content-between">
                    <div class="text-muted ms-5 px-5" id="productModalFarm">
                      —
                    </div>
                    <div
                      class="text-muted me-5 px-5"
                      id="productModalLocation"
                    ></div>
                  </div>

                  <hr class="cc-hr" />

                  <div class="mb-2">
                    <div class="fw-semibold">Price</div>
                    <div class="fs-5" id="productModalPrice">$0.00</div>
                  </div>

                  <div class="mb-3">
                    <div class="fw-semibold">Description</div>
                    <div class="text-muted" id="productModalDesc">—</div>
                  </div>

                  <div class="mt-auto">
                    <div class="row g-2 align-items-end">
                      <div class="col-12 col-sm-5">
                        <label class="form-label mb-1" for="productModalQty"
                          >Quantity</label
                        >
                        <input
                          id="productModalQty"
                          type="number"
                          class="form-control"
                          value="1"
                          min="1"
                          step="1"
                          inputmode="numeric"
                        />
                        <div class="form-text" id="productModalQtyHelp"></div>
                      </div>

                      <div class="col-12 col-sm-7 d-grid">
                        <button
                          id="productModalAddBtn"
                          class="btn cc-btn"
                          type="button"
                        >
                          Add to cart
                        </button>
                      </div>
                    </div>

                    <div
                      class="small text-muted mt-2"
                      id="productModalStatus"
                    ></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>